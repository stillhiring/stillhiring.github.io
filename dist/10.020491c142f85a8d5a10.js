(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{RnhZ:function(e,t,n){var r={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function a(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id="RnhZ"},b1Nn:function(e,t,n){"use strict";n.r(t);var r,a=n("q1tI"),i=n.n(a),o=n("i8i4"),s=n.n(o),c=n("iC7s");function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.ToggleSettingsSidebar="toggleSettingsSidebar",e.ToggleTrash="toggleTrash",e.TogglePageSettings="togglePageSettings",e.OpenSettingsForPage="openSettingsForPage",e.ClosePageSettings="closePageSettings",e.SetCurrentPageNum="setCurrentPageNum",e.TogglePageSelection="togglePageSelection",e.SetDragging="setDragging"}(r||(r={}));var p=i.a.createContext({}),f=function(e){var t=e.magModel,n=e.router,o=e.children,s={isSettingsOpened:!1,isTrashOpened:!1,isPageSettingsOpened:!1,currentPageNum:n.workspace.getPageNum(),selectedPages:{},isDragging:!1},c=function(e,t){var n=d({},e.selectedPages);return n[t]?delete n[t]:n[t]=!0,n},u=l(Object(a.useReducer)((function(e,t){switch(t.type){case r.ToggleSettingsSidebar:return d({},e,{isSettingsOpened:!e.isSettingsOpened});case r.ToggleTrash:return d({},e,{isTrashOpened:!e.isTrashOpened});case r.TogglePageSettings:return d({},e,{isPageSettingsOpened:!e.isPageSettingsOpened});case r.SetCurrentPageNum:return d({},e,{currentPageNum:t.payload});case r.TogglePageSelection:return d({},e,{selectedPages:c(e,t.payload)});case r.SetDragging:return d({},e,{isDragging:t.payload});default:return e}}),s),2),g=u[0],f=u[1];return i.a.createElement(p.Provider,{value:d({},g,{dispatch:f,setPageVisibility:function(e,n){return new Promise((function(r,a){var i=t.getPage(e);i||r(),i.save({hidden:n}).done((function(e){r(e)})).fail((function(e){a(e.responseJSON)}))}))},validatePageUri:function(e,n){var r=t.getPage(e);return r?r.validate({uri:n}):{pageNotFound:!0}}})},o)},m=function(e,t,n,r){var a=n.findIndex((function(t){return t.num===e})),i=a>=0?n[a]:null,o=e+1;if(i&&i.children&&i.children.length&&r[i._id]&&!r[i._id].collapsed){var s=n[a+1];o=s?s.num:i.children[i.children.length-1].num+1}var c=null;if(i&&i.children&&i.children.length&&r[i._id]&&r[i._id].collapsed)c=i._id;else if(!i){var l=t.find((function(t){return t.num===e}));l&&(c=l.parentPage)}return{newPageNum:o,newPageParentId:c}},h=n("za5s"),b=n("vOnD"),y=b.d.button.withConfig({displayName:"question-button__StyledButton"})(["padding:0;background:transparent;border:0;border-image:none;outline:none;cursor:pointer;"]),v=function(e){var t=e.onClick;return i.a.createElement(y,{onClick:t},i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"6px",height:"10px",viewBox:"0 0 6 10"},i.a.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.a.createElement("g",{transform:"translate(-994.000000, -39.000000)",fill:"#808080",fillRule:"nonzero"},i.a.createElement("path",{d:"M994.197187,41.8300781 C994.224531,41.1308559 994.46867,40.5634787 994.929609,40.1279297 C995.390549,39.6923806 996.033121,39.4746094 996.857344,39.4746094 C997.626879,39.4746094 998.250896,39.6796854 998.729414,40.0898438 C999.207932,40.5000021 999.447187,41.0253874 999.447187,41.6660156 C999.447187,42.5097698 999.037035,43.1777319 998.216719,43.6699219 C997.841717,43.8925792 997.58586,44.0986319 997.449141,44.2880859 C997.312421,44.47754 997.244062,44.7207016 997.244062,45.0175781 L997.244062,45.3691406 L996.031172,45.3691406 L996.025312,44.9238281 C996.009687,44.5097636 996.091718,44.1591811 996.271406,43.8720703 C996.451095,43.5849595 996.746014,43.3183606 997.156172,43.0722656 C997.515549,42.8574208 997.765546,42.6513682 997.906172,42.4541016 C998.046798,42.256835 998.117109,42.0117202 998.117109,41.71875 C998.117109,41.3945296 997.996017,41.1279307 997.753828,40.9189453 C997.511639,40.7099599 997.19133,40.6054688 996.792891,40.6054688 C996.390545,40.6054688 996.066329,40.7158192 995.820234,40.9365234 C995.574139,41.1572277 995.437422,41.4550762 995.410078,41.8300781 L994.197187,41.8300781 Z M997.36125,47.8886719 C997.197187,48.0527352 996.980392,48.1347656 996.710859,48.1347656 C996.441327,48.1347656 996.222579,48.0527352 996.054609,47.8886719 C995.88664,47.7246086 995.802656,47.509767 995.802656,47.2441406 C995.802656,46.974608 995.88664,46.7568368 996.054609,46.5908203 C996.222579,46.4248039 996.441327,46.3417969 996.710859,46.3417969 C996.980392,46.3417969 997.198163,46.4238273 997.36418,46.5878906 C997.530196,46.7519539 997.613203,46.9707018 997.613203,47.2441406 C997.613203,47.509767 997.52922,47.7246086 997.36125,47.8886719 Z"})))))};function j(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return j=function(){return e},e}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var S=i.a.createElement("path",{d:"M11.738 1a5 5 0 00-4.35 2.5l-5.149 8.918a5 5 0 00.01 5.017l5.267 9.04a5 5 0 004.301 2.484L22.28 29a5 5 0 004.35-2.5l5.149-8.918a5 5 0 00-.01-5.017l-5.267-9.04A5 5 0 0022.2 1.04l-10.463-.04zm5.273 7.987a6.013 6.013 0 110 12.026 6.013 6.013 0 010-12.026z",stroke:"#FFF",strokeWidth:2,fill:"none",fillRule:"evenodd"}),w=Object(b.d)((function(e){return i.a.createElement("svg",O({width:34,height:30},e),S)}))(j(),h.color),P=b.d.a.withConfig({displayName:"SettingsHead___StyledA"})([".user-avatar-settings-sidebar{width:56px;height:56px;}"]),x=function(e){var t=e.projectSettingsPanel,n=Object(a.useContext)(Lt);return i.a.createElement(c.i,{p:2,mb:"3px"},i.a.createElement(c.t,{alignItems:"center",justifyContent:"flex-start",position:"relative"},i.a.createElement(c.i,{width:"56px",height:"56px",mr:2,bg:"darkGray",borderRadius:"round"},i.a.createElement(P,{href:"/".concat(n.project.user.uri)},i.a.createElement(c.K,{url:n.project.user.pic,name:n.project.user.name,className:"user-avatar-settings-sidebar"}))),i.a.createElement(c.L,{size:56,color:"darkGray",onClick:function(){return t.toggle()}},i.a.createElement(w,null)),i.a.createElement(c.i,{position:"absolute",right:8,mt:"-1px"},i.a.createElement(v,{onClick:function(){}}))))},_=n("wd/R"),E=n.n(_),C=n("xG9w"),k=n("wEEd"),T=n("y4v0"),N=n("OTSC"),I=Object(b.d)(c.H).withConfig({displayName:"PageScreenshot___StyledPicture"})(["border-radius:4px;opacity:",";filter:blur(",");"],(function(e){return e._css}),(function(e){return e._css2})),D=function(e){var t=e.url,n=e.opacity,r=e.blur,a=void 0!==r&&r;if(!t)return null;var o=N.default.screenshotSize(256),s=N.default.addFilenameComponent(t,o);return i.a.createElement(c.i,{width:"100%",height:"100%",position:"relative"},i.a.createElement(I,{width:"100%",height:"100%",src:s,_css:void 0!==n?n:1,_css2:a?"1px":0}),i.a.createElement(c.i,{width:"100%",height:"100%",position:"absolute",top:0,left:0}))};function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var A=Object(b.d)(c.i).withConfig({displayName:"PageListItem___StyledBox"})(["user-select:",";"],(function(e){return e._css})),B=Object(b.d)(c.t).withConfig({displayName:"PageListItem___StyledFlex"})(["cursor:pointer;z-index:1;transform:rotate(",") translateX(",");transition:transform 200ms ease;"],(function(e){return e._css2}),(function(e){return e._css3})),R=Object(b.d)(c.i).withConfig({displayName:"PageListItem___StyledBox2"})(["box-shadow:",";cursor:pointer;:hover{.page-actions-popup{opacity:",";display:",";}.page-actions-button{opacity:",";display:",";}}transform-origin:left;transform:scale(",");"],(function(e){return e._css4}),(function(e){return e._css5}),(function(e){return e._css6}),(function(e){return e._css7}),(function(e){return e._css8}),(function(e){return e._css9})),L=i.a.memo((function(e){var t=e.page,n=e.gridSize,o=e.level,s=void 0===o?0:o,l=e.head,u=e.isCmdPressed,d=e.onCollapsed,g=e.isPageCollapsed,f=void 0===g||g,m=Object(a.useContext)(Lt),h=Object(a.useContext)(p),b=s?16*s:s,y=z(Object(a.useState)(t.num===m.currentPageNum),2),v=y[0],j=y[1];Object(a.useEffect)((function(){j(t.num===m.currentPageNum)}),[m.currentPageNum]);return i.a.createElement(A,{width:"192px",my:"6px",ml:"".concat(b,"px"),position:"relative",display:n===fe.Standard?"block":"flex",_css:h.isDragging?"none":"auto"},v&&i.a.createElement(c.i,{width:"6px",height:"6px",borderRadius:"round",bg:"tomato",position:"absolute",top:n===fe.Standard?60:"25px",left:"-15px",zIndex:1}),l?i.a.createElement(B,{width:12,height:12,position:"absolute",top:n===fe.Standard?134:14,left:n===fe.Standard?-3:93,alignItems:"center",justifyContent:"center",onClick:function(){d&&d()},_css2:f?"0deg":"-90deg",_css3:f?fe.Standard?"3px":"2px":"0px"},i.a.createElement(c.cb,{color:"black"})):null,i.a.createElement(R,{width:n===fe.Standard?192:"88px",height:n===fe.Standard?124:"56px",className:"page-list-item-picture",mb:s?1:"0px",bg:"white",borderRadius:"s",position:"relative",zIndex:1,"data-page-id":t._id,onClick:function(e){e.preventDefault();var t=e.currentTarget.dataset.pageId;t&&(u?h.dispatch({type:r.TogglePageSelection,payload:t}):(j(!0),window.RM.constructorRouter.showWorkspace({id:t})))},_css4:h.selectedPages[t._id]?"0 0 0 4px #f4f4f4, 0 0 0 8px #ec520b":"0 1px 1px rgba(64, 64, 64, 0.32)",_css5:!v&&h.isPageSettingsOpened?0:1,_css6:!v&&h.isPageSettingsOpened?"none":"flex",_css7:!v&&h.isPageSettingsOpened?0:1,_css8:!v&&h.isPageSettingsOpened?"none":"block",_css9:s&&n===fe.Standard?"0.9":"1"},i.a.createElement(D,{url:t.screenshot,opacity:t.hidden?.4:1}),i.a.createElement(G,{isCurrentPage:v,pageId:t._id,isPageHidden:t.hidden,gridSize:n,hidden:!!h.isDragging})),i.a.createElement(c.i,null,i.a.createElement(c.i,{width:"100%",ml:"".concat(n===fe.Standard?l?16:0:l?24:8,"px"),mt:"".concat(n===fe.Standard?6:10,"px")},i.a.createElement(c.Y,{textStyle:"small"},t.num,"."),i.a.createElement(c.Y,{textStyle:"small",color:t.title?"black":"darkGray"}," ",t.title?t.title:"Page Title")),i.a.createElement(c.i,{width:"100%",ml:"".concat(n===fe.Standard?l&&f?16:0:8,"px"),mt:"-2px"},i.a.createElement(c.Y,{textStyle:"small",color:t.uri?"black":"darkGray"},t.uri?"/".concat(t.uri):"/custom url"))))}));L.displayName="PageListItem";var G=i.a.memo((function(e){var t=e.isCurrentPage,n=e.pageId,o=e.isPageHidden,s=e.gridSize,c=e.hidden,l=void 0!==c&&c,u=Object(a.useContext)(p),d=Object(a.useContext)(Lt),g=function(e){e.preventDefault(),e.stopPropagation(),d.deletePage(n)},f=function(e){e.preventDefault(),e.stopPropagation(),d.duplicatePage(n).then((function(){})).catch((function(e){console.warn("page dublicate",e)}))},m=function(e){e.preventDefault(),e.stopPropagation(),u.isTrashOpened?(u.dispatch({type:r.ToggleTrash}),setTimeout((function(){u.dispatch({type:r.TogglePageSettings})}),300)):u.dispatch({type:r.TogglePageSettings})};return l?null:s===fe.Standard?i.a.createElement(W,{isCurrentPage:t,isPageHidden:o,isPageSettingsOpened:u.isPageSettingsOpened,onPageDuplicate:f,onPageSettingsToggle:m,onPageDelete:g}):i.a.createElement(H,{isCurrentPage:t,isPageHidden:o,isPageSettingsOpened:u.isPageSettingsOpened,onPageDuplicate:f,onPageSettingsToggle:m,onPageDelete:g})}));G.displayName="PageActionsPopup";var F,Y=Object(b.d)(c.t).withConfig({displayName:"PageListItem___StyledFlex2"})(["opacity:",";transition:opacity 200ms ease;"],(function(e){return e._css10})),M=Object(b.d)(c.L).withConfig({displayName:"PageListItem___StyledRoundButton"})(["display:",";"],(function(e){return e._css11})),U=Object(b.d)(c.L).withConfig({displayName:"PageListItem___StyledRoundButton2"})(["display:",";"],(function(e){return e._css12})),V=Object(b.d)(c.L).withConfig({displayName:"PageListItem___StyledRoundButton3"})(["display:",";"],(function(e){return e._css13})),W=i.a.memo((function(e){var t=e.isCurrentPage,n=e.isPageHidden,r=e.isPageSettingsOpened,a=e.onPageDuplicate,o=e.onPageSettingsToggle,s=e.onPageDelete;return i.a.createElement(Y,{className:"page-actions-popup",width:177,height:34,justifyContent:"space-between",position:"absolute",bottom:7,left:7,_css10:t?"1":"0"},i.a.createElement(c.i,null,i.a.createElement(M,{size:34,color:"white",disabled:r,onClick:a,_css11:r?"none":"flex"},i.a.createElement(c.o,{color:"black"}))),i.a.createElement(c.i,null,i.a.createElement(c.L,{size:34,color:"white",onClick:o,"data-hovered":t&&r},i.a.createElement(c.N,{color:"black"}))),i.a.createElement(c.i,null,i.a.createElement(U,{size:34,color:"white",_css12:r?"none":"flex"},n?i.a.createElement(c.p,{color:"black"}):i.a.createElement(c.q,{color:"black"}))),i.a.createElement(c.i,null,i.a.createElement(V,{size:34,color:"white",onClick:s,_css13:r?"none":"flex"},i.a.createElement(c.n,{color:"black"}))))}));W.displayName="PageActionsStandartPanel",function(e){e.Duplicate="duplicate",e.Delete="detele",e.Settings="settings"}(F||(F={}));var X=Object(b.d)(c.i).withConfig({displayName:"PageListItem___StyledBox3"})(["opacity:",";transition:opacity 200ms ease;box-shadow:0 0 0 1px rgba(128,128,128,0.16);"],(function(e){return e._css14})),H=i.a.memo((function(e){var t=e.isCurrentPage,n=(e.isPageHidden,e.isPageSettingsOpened),r=e.onPageDuplicate,o=e.onPageSettingsToggle,s=e.onPageDelete,l=z(Object(a.useState)(!1),2),u=l[0],d=l[1],g=z(Object(a.useState)({x:0,y:0}),2),p=g[0],f=g[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(J,{isShown:u,isPageSettingsOpened:n,coords:p,callback:function(e,t){switch(e){case F.Duplicate:d(!1),r(t);break;case F.Delete:d(!1),s(t);break;case F.Settings:o(t)}}}),i.a.createElement(X,{className:"page-actions-button",width:32,height:32,position:"absolute",top:12,left:7,borderRadius:"round",_css14:t?"1":"0"},i.a.createElement(c.L,{size:32,color:"white",onClick:function(e){return function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget.getBoundingClientRect();f({x:t.x,y:t.y+t.height/2}),d(!u)}(e)}},i.a.createElement(c.db,{color:"black"}))))}));H.displayName="PageActionsSmallPanel";var Q=Object(b.d)(c.i).withConfig({displayName:"PageListItem___StyledBox4"})(["transform:translateX(",");transition:0.3s transform ease;"],(function(e){return e._css15})),Z=Object(b.d)(c.i).withConfig({displayName:"PageListItem___StyledBox5"})(["background-color:rgba(40,40,40,0.92);"]),J=function(e){var t=e.isShown,n=e.isPageSettingsOpened,r=e.coords,a=e.callback;return t?s.a.createPortal(i.a.createElement(Q,{position:"absolute",left:r.x-160,top:r.y-80,zIndex:8e3,_css15:n?"-240px":"0px"},i.a.createElement(Z,{width:148,height:160,borderRadius:"l",bg:"black",pl:3,pt:12},i.a.createElement(c.i,null,i.a.createElement(c.j,{textStyle:"subheading",color:"white",onClick:function(e){return a(F.Duplicate,e)}},"Duplicate")),i.a.createElement(c.i,{mt:12},i.a.createElement(c.j,{textStyle:"subheading",color:n?"tomato":"white",onClick:function(e){return a(F.Settings,e)}},"Settings")),i.a.createElement(c.i,{mt:12},i.a.createElement(c.j,{textStyle:"subheading",color:"white"},"Show")),i.a.createElement(c.i,{mt:12},i.a.createElement(c.j,{textStyle:"subheading",color:"white",onClick:function(e){return a(F.Delete,e)}},"Delete"))),i.a.createElement(c.t,{position:"absolute",top:68,right:-8},i.a.createElement(c.ab,{color:"black"}))),document.getElementsByTagName("body")[0]):null},K=4e3,q=124,$=112,ee=56,te=192,ne=172,re=88;function ae(){return(ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var oe=Object(b.d)(k.a.div).withConfig({displayName:"DraggableItem__DraggingPage"})(["position:absolute;box-sizing:border-box;cursor:pointer;z-index:2;pointer-events:none;user-select:none;-webkit-user-select:none;&:-webkit-drag{cursor:pointer;pointer-events:none;user-select:none;}"]),se="undefined"!=typeof window&&(window.requestAnimationFrame||window.setImmediate)||function(e){return setTimeout(e,0)},ce=Object(b.d)(c.i).withConfig({displayName:"DraggableItem___StyledBox"})(["box-shadow:0 1px 1px rgba(64,64,64,0.32);"]),le=i.a.memo((function(e){var t=Object(a.useContext)(p),n=Object(a.useContext)(Lt),o=Object(a.useRef)(null),c=Object(a.useRef)(null);Object(a.useEffect)((function(){return e.level&&Y(!0),function(){W.cancel()}}),[]);var l=Object(a.useMemo)((function(){return n.settingsBody?n.settingsBody.getBoundingClientRect():{}}),[n.settingsBody]),u=Object(a.useMemo)((function(){return n.pagesListContainer?n.pagesListContainer.getBoundingClientRect():{}}),[n.pagesListContainer]),d=ie(Object(k.b)((function(){return{y:0}})),2),g=d[0].y,f=d[1],m=ie(Object(a.useState)({offset:0,state:!1}),2),h=m[0],b=m[1],y=i.a.useRef(),v=ie(Object(a.useState)(!1),2),j=v[0],O=v[1],S=i.a.useRef(0),w=i.a.useRef(0),P=n.settingsBody;Object(a.useEffect)((function(){return j?x():_(),function(){return _()}}),[j]);var x=function(){!S.current&&j&&h.state&&(S.current=se(E))},_=function(){S.current&&(window.cancelAnimationFrame(S.current),S.current=0,w.current=0)},E=function e(){P&&j&&(P.scrollBy(0,w.current),S.current=se(e))},N=ie(Object(a.useState)(null),2),I=N[0],z=N[1],A=ie(Object(a.useState)(null),2),B=A[0],R=A[1],G=ie(Object(a.useState)(!1),2),F=G[0],Y=G[1],M=i.a.useRef(),U=i.a.useRef(0);Object(a.useEffect)((function(){U.current=e.gridSize===fe.Small?ee:F?$:q}),[e.gridSize,F]);var V=function(){I&&(W.cancel(),I.style.removeProperty("box-shadow"),z(null))},W=Object(C.a)((function(t){if(!(t.dataset.pageLevel&&parseInt(t.dataset.pageLevel)||n.pagesParams[e.page._id]&&n.pagesParams[e.page._id].children.length||!h.state||j)){var r=t.querySelector(".page-list-item-picture");if(r&&y.current){var a=y.current.clientY,i=r.getBoundingClientRect();if(a<=i.top||a>=i.bottom)return;I?I.dataset.pageId!==r.dataset.pageId&&(I.style.removeProperty("box-shadow"),r.style.boxShadow="0 0 0 4px #f4f4f4, 0 0 0 8px #B8B8B8",z(r)):(r.style.boxShadow="0 0 0 4px #f4f4f4, 0 0 0 8px #B8B8B8",z(r))}}}),1e3),X=function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];B&&B.elem&&(Q(B.elem,e),R(null))}(),document.querySelectorAll(".drag-shadow-block").forEach((function(e){e.remove()}))},H=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,i=document.createElement("div");return i.className="drag-shadow-block",i.style.width=e.gridSize===fe.Small?"".concat(re,"px"):"".concat(a?ne:te,"px"),i.style.marginTop="6px",i.style.marginBottom="6px",i.style.marginLeft=a?"16px":"0",i.style.boxSizing="border-box",i.style.border="1px solid #0080FF",i.style.borderRadius="4px",r?(i.style.height="0px",i.style.transition="height 0.2s linear 0s"):i.style.height="".concat(U.current,"px"),{pageId:t,position:n,elem:i}},Q=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?(e.style.transition="height 0.2s linear 0s",e.style.height="0px",setTimeout((function(){e.remove()}),200)):e.remove()},Z=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=null!==a?a:F,o=H(e,n,r,i);B&&B.elem&&Q(B.elem,r),n===Ct.After||n===Ct.AfterOutside?t.after(o.elem):t.before(o.elem),r&&setTimeout((function(){o.elem.style.height="".concat(U.current,"px")}),0),R(o)},J=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e?e.pageId!==t.dataset.pageId&&e.position!==n?Z(t.dataset.pageId,t.parentNode,n,!1,r):e.pageId===t.dataset.pageId&&e.position===n||Z(t.dataset.pageId,t.parentNode,n,!0,r):Z(t.dataset.pageId,t,n,!0,r)},K=function(){o.current&&(F&&o.current.parentNode&&(o.current.parentNode.style.height="auto",M.current=e.page.parentPage),function(){var t=e.level?o.current:o.current.parentNode;if(t){if(1===n.pages.length||e.page.parentPage&&1===n.pagesParams[e.page.parentPage].children.length)return void Z(e.page._id,t,Ct.After);var r=n.pages.findIndex((function(t){return t._id===e.page._id})),a=n.pages[r-1];if(a&&a.parentPage===e.page.parentPage)return void Z(a._id,t.previousSibling,Ct.After);var i=n.pages[r+1];if(i&&i.parentPage===e.page.parentPage)return void Z(i._id,t.nextSibling,Ct.Before)}Z(e.page._id,o.current.parentNode,Ct.After)}()),t.dispatch({type:r.SetDragging,payload:!0})},le=function(){j&&O(!1),y.current=void 0,W.cancel();var a={changingId:e.page._id};if(I&&I.dataset.pageId?(a.targetId=I.dataset.pageId,a.position=Ct.Inside):B&&(a.targetId=B.pageId,a.position=B.position),V(),document.querySelectorAll(".page-list-item-picture").forEach((function(e){e.style.removeProperty("box-shadow")})),X(),a.changingId&&a.targetId&&a.position){var i=n.getNewPageOrderElement(a);if(i instanceof Error)return console.warn(i),Error;n.reorderPage(e.page._id,i)}t.dispatch({type:r.SetDragging,payload:!1})},ue=Object(T.a)((function(t){var r=t.down,a=ie(t.movement,2)[1],i=t.event,s=a;if(c.current&&h.state&&(y.current=i,s=ge(a),pe(a),j||de(i,c.current)),h.state!==r){var l=n.pagesParams[e.page._id];if(l&&l.children.length&&l.collapsed)return;if(r){var u=o.current?o.current.getBoundingClientRect().top+6:0;K(),b({offset:u,state:!0})}else le(),b({offset:0,state:!1})}f({y:r?s:0,immediate:r})}),{capture:!0,filterTaps:!0,axis:"y"}),de=function(t,r){r.hidden=!0;var a=document.elementFromPoint(t.clientX,t.clientY);if(r.hidden=!1,a){var i,o,s=a.closest(".page-list-draggable-item");if(s){if(s&&s.dataset.pageId&&s.dataset.pageId!==e.page._id){var c=s.getBoundingClientRect(),l=r.getBoundingClientRect(),u=(o=c,(i=l).bottom-i.height/2-(o.bottom-o.height/2));W(s);var d=Boolean(s.dataset.pageLevel&&!!parseInt(s.dataset.pageLevel)),g=!1;d!==F&&(g=!0,d?s.parentNode&&(s.parentNode.parentNode.style.height="auto",M.current=s.parentNode.dataset.parentId):M.current=void 0,Y(d));var p=e.gridSize===fe.Standard?25:12;u>=p?J(B,s,Ct.After,g?d:null):u<=p&&J(B,s,Ct.Before,g?d:null)}}else V(),F&&function(e,t){if(M.current&&e.target&&e.target.classList.contains("drag-shadow-block")){var r=e.target.parentNode.getBoundingClientRect();if(t.getBoundingClientRect().bottom-r.bottom>10){var a=n.pagesParams[M.current];a&&(M.current=void 0,Z(a.children[a.children.length-1],e.target.parentNode.parentNode,Ct.AfterOutside,!1,!1),Y(!1))}}}(t,r)}},ge=function(e){return n.pagesListContainer?h.offset+e<u.top-0?e-(h.offset+e-u.top+0):h.offset+U.current+e>u.bottom+0?e-(h.offset+U.current+e-u.bottom-0):e:e},pe=function(e){if(n.settingsBody)if(h.offset+e<l.top){var t=Math.ceil((h.offset+e-l.top)/4);n.settingsBody.scrollTop?(w.current=t,j||O(!0)):j&&O(!1)}else if(h.offset+U.current+e>l.bottom){var r=Math.ceil((h.offset+U.current+e-l.bottom)/4);n.settingsBody.scrollTop+n.settingsBody.clientHeight<n.settingsBody.scrollHeight?(w.current=r,j||O(!0)):j&&O(!1)}else j&&O(!1)};return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",ae({className:"page-list-draggable-item","data-page-id":e.page._id,"data-page-level":e.level,ref:o},ue(),{style:{boxSizing:"border-box",display:h.state?"none":"block"}}),i.a.createElement(L,e)),h.state&&n.dragContainer?s.a.createPortal(i.a.createElement(oe,{ref:c,style:{transform:g.interpolate((function(e){return"translate(0, ".concat(e,"px)")})),top:h.offset}},i.a.createElement(ce,{width:e.gridSize===fe.Small?"".concat(re,"px"):"".concat(F?ne:te,"px"),height:"".concat(U.current,"px"),ml:F?"40px":"24px",bg:"white",borderRadius:"s"},i.a.createElement(D,{url:e.page.screenshot}))),n.dragContainer):null)}));function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}le.displayName="DraggableItem";var de=Object(b.d)(c.i).withConfig({displayName:"Branch___StyledBox"})(["height:",";overflow-x:hidden;transition:height 200ms ease;"],(function(e){return e._css})),ge=i.a.memo((function(e){var t=e.page,n=e.gridSize,r=e.level,o=void 0===r?0:r,s=e.isCmdPressed,l=Object(a.useContext)(Lt),u=ue(Object(a.useState)(null),2),d=u[0],g=u[1],p=Object(a.useRef)(null),f=!(!t.children||!t.children.length),m=!l.pagesParams[t._id]||l.pagesParams[t._id].collapsed,h=t.children&&t.children.length?t.children.map((function(e){return e.num_id})).join(";"):"";Object(a.useEffect)((function(){se((function(){p&&p.current&&(p.current.style.height="auto",g(p.current.scrollHeight),p.current.style.removeProperty("height"))}))}),[n,h]),p&&p.current&&p.current.style.removeProperty("height");var b=Object(a.useCallback)((function(){l.setPageCollapse(t._id,!m)}),[t._id,m]);return i.a.createElement(c.i,{position:"relative"},i.a.createElement(le,{page:t,gridSize:n,level:o,head:f,isCmdPressed:s,onCollapsed:b,isPageCollapsed:m}),t.children&&f?i.a.createElement(de,{className:"page-children-container",ref:p,"data-parent-id":t._id,_css:m?d?"".concat(d,"px"):"auto":"0px"},t.children.map((function(e){return e.children?i.a.createElement(ge,{key:e._id,page:e,gridSize:n,level:o+1,isCmdPressed:s}):i.a.createElement(le,{key:e._id,page:e,gridSize:n,level:o+1,isCmdPressed:s})}))):null)}));function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}ge.displayName="Branch";var fe,me=function(e){var t=e.gridSize,n=Object(a.useContext)(p),r=Object(a.useContext)(Lt);Object(a.useEffect)((function(){window.RM.constructorRouter.pageOrder.fixPageOrder(window.RM.constructorRouter.mag)}),[n.isSettingsOpened]);var o=pe(Object(a.useState)(!1),2),s=o[0];o[1];return i.a.createElement(c.t,{id:"page-list-container",flexDirection:"column",justifyContent:"left",flexWrap:"wrap",px:3,py:"6px"},r.pagesTree.map((function(e){return i.a.createElement(ge,{key:e._id,page:e,isCmdPressed:s,gridSize:t})})))};function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}!function(e){e[e.Standard=0]="Standard",e[e.Small=1]="Small"}(fe||(fe={}));var be=Object(b.d)(c.i).withConfig({displayName:"SettingsBody___StyledBox"})(["overflow-x:visible;overflow-y:auto;user-select:",";"],(function(e){return e._css})),ye=Object(b.d)(c.Q).withConfig({displayName:"SettingsBody___StyledStandardGridIcon"})(["cursor:pointer;rect{fill:",";}"],(function(e){return e._css2})),ve=Object(b.d)(c.P).withConfig({displayName:"SettingsBody___StyledSmallGridIcon"})(["cursor:pointer;path{fill:",";}"],(function(e){return e._css3})),je=function(){var e,t=Object(a.useContext)(Lt),n=he(Object(a.useState)(fe.Standard),2),r=n[0],o=n[1];return i.a.createElement(be,{id:"project-settings-body",width:1,height:"calc(100% - 72px - 75px)",position:"relative",_css:t?"none":"auto"},i.a.createElement(c.i,{px:3},i.a.createElement(c.i,null,i.a.createElement(c.Y,{color:"black",textStyle:"subheading"},t.project.title||"Project Title")),i.a.createElement(c.i,{mt:"7px",position:"relative"},i.a.createElement(c.Y,{color:"darkGray",textStyle:"small"},(e=t.project).is_published?e.changed?"Unpublished changes":"Published ".concat(E()(e.published).format("MMM D, YYYY")):"Unpublished"),i.a.createElement(c.t,{mt:"14px",onClick:function(){return o((function(e){return e===fe.Standard?fe.Small:fe.Standard}))}},i.a.createElement(c.i,null,i.a.createElement(ye,{_css2:r===fe.Standard?"#808080":"#B8B8B8"})),i.a.createElement(c.i,{ml:"1"},i.a.createElement(ve,{_css3:r===fe.Small?"#808080":"#B8B8B8"}))))),i.a.createElement(me,{gridSize:r}))},Oe=n("YqYG"),Se=function(){var e=Object(a.useContext)(p),t=Object(a.useContext)(Lt),n=Object(a.useRef)(new Oe.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-more-pages",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:t.project.user?t.project.user.email:""},alert_source:"custom sharing"})).current;return i.a.createElement(c.i,{width:1,height:80,position:"absolute",left:0,bottom:0},i.a.createElement(c.j,{color:"darkGray",textStyle:"small",position:"absolute",left:24,bottom:37},"Add"),i.a.createElement(c.j,{position:"absolute",left:107,bottom:28},i.a.createElement(c.I,{onClick:function(e){e.preventDefault(),t.addNewPage(t.currentPageNum).then((function(){})).catch((function(e){e&&e.err&&"permission_denied"===e.err&&n.render()}))}})),t.project.has_deleted_pages&&i.a.createElement(c.j,{color:e.isTrashOpened?"tomato":"darkGray",textStyle:"small",position:"absolute",right:26,bottom:37,onClick:function(n){n.preventDefault(),(t.project.has_deleted_pages||e.isTrashOpened)&&e.dispatch({type:r.ToggleTrash})}},e.isTrashOpened?"Close":"Bin"))};function we(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Pe=b.d.div.withConfig({displayName:"Trash__TrashSidebar"})(["height:100%;width:240px;padding:12px 22px;box-sizing:border-box;position:fixed;top:0;right:0;bottom:0;z-index:4000;background-color:",";overflow-x:hidden;overflow-y:auto;transform:translateX( "," );transition:transform 300ms ease;"],Object(h.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isTrashOpened?"0px":"240px":e.isTrashOpened?"480px":"240px"})),xe=i.a.memo((function(){var e=Object(a.useContext)(p),t=Object(a.useContext)(Lt);Object(a.useEffect)((function(){e.isTrashOpened?(document.body.classList.add("trash-is-opened"),t.updateTrash()):document.body.classList.remove("trash-is-opened")}),[e.isTrashOpened]);var n=function(e){return t.restorePage(e)},r=function(e){return t.deletePagesFromTrash([e])};return i.a.createElement(Pe,{isTrashOpened:e.isTrashOpened,isSettingsOpened:e.isSettingsOpened},i.a.createElement(c.i,{height:"calc(100% - 80px)",overflow:"auto"},i.a.createElement(c.i,{mb:28},i.a.createElement(c.Y,{color:"white",textStyle:"subheading",textAlign:"left"},"Deleted pages")),t.trashPages.map((function(e){return i.a.createElement(Ie,{key:e._id,page:e,isOwner:t.isOwner,onRestorePage:n,onDeletePage:r})}))),t.trashPages.length?i.a.createElement(ze,{onEmptyTrash:function(){t.isOwner&&t.trashPages&&t.emptyTrash()},isOwner:t.isOwner}):null)}));xe.displayName="Trash";var _e=Object(b.d)(c.i).withConfig({displayName:"Trash___StyledBox"})([":hover{.trash-page-actions{opacity:1;}}"]),Ee=Object(b.d)(c.t).withConfig({displayName:"Trash___StyledFlex"})(["opacity:0;transition:opacity 200ms ease;"]),Ce=Object(b.d)(c.t).withConfig({displayName:"Trash___StyledFlex2"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);"]),ke=Object(b.d)(c.t).withConfig({displayName:"Trash___StyledFlex3"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);transition:opacity 0.2s ease;&:hover{opacity:0.8;}"]),Te=Object(b.d)(c.t).withConfig({displayName:"Trash___StyledFlex4"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);transition:opacity 0.2s ease;&:hover{opacity:0.8;}"]),Ne=Object(b.d)(c.t).withConfig({displayName:"Trash___StyledFlex5"})(["cursor:",";border:1px solid rgba(128,128,128,0.16);"],(function(e){return e._css})),Ie=i.a.memo((function(e){var t=e.page,n=e.isOwner,r=e.onRestorePage,o=e.onDeletePage,s=we(Object(a.useState)(!1),2),l=s[0],u=s[1];return i.a.createElement(c.i,{mb:12,ml:"2px"},i.a.createElement(_e,{width:192,height:124,bg:"darkGray",borderRadius:"s",position:"relative"},i.a.createElement(D,{url:t.screenshot}),i.a.createElement(Ee,{className:"trash-page-actions",width:176,height:32,justifyContent:"space-between",position:"absolute",left:8,bottom:8},l?i.a.createElement(Ce,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"tomato",borderRadius:"xl",onClick:function(e){e.preventDefault(),n&&o(t._id)}},i.a.createElement(c.Y,{textStyle:"small",color:"white"},"Yes")):i.a.createElement(ke,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(e){e.preventDefault(),r(t._id)}},i.a.createElement(c.Y,{textStyle:"small",color:"black"},"Restore")),l?i.a.createElement(Te,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(e){e.preventDefault(),u(!1)}},i.a.createElement(c.Y,{textStyle:"small",color:"black"},"Cancel")):i.a.createElement(Ne,{width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(e){e.preventDefault(),u(!0)},_css:n?"pointer":"not-allowed"},i.a.createElement(c.Y,{textStyle:"small",color:n?"black":"gray"},"Delete")))),i.a.createElement(c.i,{mt:"7px"},i.a.createElement(c.Y,{textStyle:"small",color:"white"},t.title?t.title:"Page Title")))}));Ie.displayName="TrashPage";var De=Object(b.d)(c.j).withConfig({displayName:"Trash___StyledButton"})(["cursor:",";"],(function(e){return e._css2})),ze=i.a.memo((function(e){var t=e.onEmptyTrash,n=e.isOwner;return i.a.createElement(c.t,{height:80,justifyContent:"center",alignItems:"center",borderTop:"2px solid #B8B8B8",position:"relative",top:12},i.a.createElement(De,{textStyle:"small",color:n?"white":"gray",onClick:t,_css2:n?"pointer":"not-allowed"},"Empty bin"))}));ze.displayName="TrashFooter";var Ae=xe,Be=n("tZHv");function Re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(n,!0).forEach((function(t){Fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ye=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel"})(["color:",";",";"],(function(e){return e._css}),(function(e){return e._css2})),Me=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel2"})(["color:",";",";"],(function(e){return e._css3}),(function(e){return e._css4})),Ue=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel3"})(["color:",";",";"],(function(e){return e._css5}),(function(e){return e._css6})),Ve=b.d.label.withConfig({displayName:"SeoSettings___StyledLabel4"})(["color:",";",";"],(function(e){return e._css7}),(function(e){return e._css8})),We=i.a.memo((function(e){var t=e.currentPage,n=Object(a.useContext)(p),r=Object(a.useContext)(Lt),o=function(){var e={title:"",description:"",keywords:""};return t&&t.seo&&(e=Ge({},e,{},t.seo)),e},s=Re(Object(a.useState)((function(){return o()})),2),l=s[0],u=s[1],d=Re(Object(a.useState)((function(){return t&&t.uri?t.uri:""})),2),g=d[0],f=d[1],m=Re(Object(a.useState)(null),2),b=m[0],y=m[1];Object(a.useEffect)((function(){u(o()),t&&f(t.uri||""),b&&y(null)}),[t]);var v,j,O,S=function(e){var n=e.target.getAttribute("name");if(n&&void 0!==l[n]&&t){var a=Ge({},l,{},Fe({},n,e.target.value)),i=r.pageSave(t._id,{seo:a});!i||i instanceof Error||i.done((function(e){})).fail((function(){}))}};return i.a.createElement("form",null,i.a.createElement(c.i,{mt:"12px"},i.a.createElement(Ye,{htmlFor:"title",_css:Object(h.themeGet)("colors.white"),_css2:Object(h.themeGet)("textStyles.small")},"Title"),i.a.createElement(c.y,{name:"title",id:"title",color:"white",placeholder:"Cover",translate:"no",maxLength:128,autoSize:!0,mt:"4px",defaultValue:l.title,onBlur:S})),i.a.createElement(c.i,{mt:"2px"},i.a.createElement(Me,{htmlFor:"description",_css3:Object(h.themeGet)("colors.white"),_css4:Object(h.themeGet)("textStyles.small")},"Description"),i.a.createElement(c.y,{name:"description",id:"description",color:"white",placeholder:"What's it about...",translate:"no",maxLength:2048,autoSize:!0,mt:"4px",defaultValue:l.description,onBlur:S})),i.a.createElement(c.i,{mt:"2px"},i.a.createElement(Ue,{htmlFor:"keywords",_css5:Object(h.themeGet)("colors.white"),_css6:Object(h.themeGet)("textStyles.small")},"Keywords"),i.a.createElement(c.y,{name:"keywords",id:"keywords",color:"white",placeholder:"Design, fashion",translate:"no",spellCheck:!1,autoSize:!0,mt:"4px",defaultValue:l.keywords,onBlur:S})),i.a.createElement(c.i,{mt:"2px"},i.a.createElement(Ve,{htmlFor:"link",_css7:Object(h.themeGet)("colors.white"),_css8:Object(h.themeGet)("textStyles.small")},(v=r.project,j=Be.a.readymag_host.split("//")[1],O=v.domain,v.user.domain||O||j)),i.a.createElement(c.t,{flexWrap:"wrap"},i.a.createElement(c.Y,{color:"white",fontSize:"small"},function(e){var t=e.domain,n=e.user.domain,r=e.uri,a=e.user.uri;return n?"/"+r+"/":t?"/":"/"+a+"/"+r+"/"}(r.project)),i.a.createElement(c.x,{name:"link",id:"link",type:"text",color:"white",fontSize:"regular",spellCheck:!1,placeholder:t?"/".concat(t.num.toString()):"/",value:b||g,onKeyDown:function(e){y(null),13===e.keyCode&&(e.preventDefault(),e.currentTarget.blur())},onChange:function(e){if(t){var r=/[^A-Za-z0-9_.+-]/g,a=e.currentTarget.value;r.test(a)&&(a=a.replace(r,""));var i=n.validatePageUri(t._id,a);if(i){var o={hyphen:"The link cannot begin or end with a hyphen",onlyNumbers:"The link cannot be numeric",uriLength:"The link’s max length is 128 characters",used:"This link is already used",pageNotFound:"Can't found current page"}[Object.keys(i)[0]];y(o)}else f(a)}},onBlur:function(e){if(t&&!b){var n=e.currentTarget.value,a=r.pageSave(t._id,{uri:n});!a||a instanceof Error||a.done((function(e){f(e.uri||"")})).fail((function(){}))}}}))))})),Xe=n("LDvm"),He=n("+9Qk");function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(n,!0).forEach((function(t){Je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ke(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}function qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var $e,et=Object(b.d)(c.j).withConfig({displayName:"SocialSettings__CustomizeButton"})(["width:100%;height:40px;border:solid 2px ",";border-radius:32px;"],Object(h.themeGet)("colors.darkGray"));!function(e){e.Default="default",e.Custom="custom",e.Inherited="inherited"}($e||($e={}));var tt=Object(b.d)(c.i).withConfig({displayName:"SocialSettings___StyledBox"})(["box-shadow:0 1px 1px rgba(64,64,64,0.32);cursor:pointer;"]),nt=Object(b.d)(c.i).withConfig({displayName:"SocialSettings___StyledBox2"})(["background-image:",";background-size:cover;background-repeat:no-repeat;"],(function(e){return e._css})),rt=Object(b.d)(c.y).withConfig({displayName:"SocialSettings___StyledInlineTextArea"})(["&:disabled{opacity:0.4;}"]),at=Object(b.d)(c.y).withConfig({displayName:"SocialSettings___StyledInlineTextArea2"})(["&:disabled{opacity:0.4;}"]),it=b.d.label.withConfig({displayName:"SocialSettings___StyledLabel"})(["color:",";",";"],(function(e){return e._css2}),(function(e){return e._css3})),ot=Object(b.d)(c.y).withConfig({displayName:"SocialSettings___StyledInlineTextArea3"})(["&:disabled{opacity:0.4;}"]),st=b.d.label.withConfig({displayName:"SocialSettings___StyledLabel2"})(["color:",";",";"],(function(e){return e._css4}),(function(e){return e._css5})),ct=i.a.memo((function(e){var t=e.currentPage,n=Object(a.useContext)(Lt),r=new Oe.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-custom-sharing",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:n.project.user?n.project.user.email:""},alert_source:"custom sharing"}),o=qe(Object(a.useState)((function(){return!!window.RM.constructorRouter.me&&!!(window.RM.constructorRouter.me.get("permissions")||{}).custom_sharing})),1)[0],s=qe(Object(a.useState)((function(){return n.project.master_share_pid||null})),2),l=s[0],u=s[1],d=function(e){var n=e||t;return n?l?l===n._id?$e.Custom:$e.Inherited:n.custom_shares?$e.Custom:$e.Default:$e.Default},g=qe(Object(a.useState)(d()),2),p=g[0],f=g[1],m=function(){return p===$e.Default||p===$e.Inherited},b=function(e){if(e.custom_shares){var t=e.custom_shares;if(!t.image){var n=N.default.screenshotSize(256),r=N.default.addFilenameComponent(e.screenshot,n);t.image=r}return t}return{description:"",title:"",tweet:"",image:""}},y=function(e){var r=e||t;if(!r)return null;var a=n.project.domain||n.project.user&&n.project.user.domain,i=He.a.getDefaultShare(r,n.project,{customDomain:Boolean(a)});if(l){if(l===r._id)return b(r);var o=n.pages.find((function(e){return e._id===l}));if(o)return b(o)}else if(r.custom_shares)return b(r);return i},j=qe(Object(a.useState)((function(){return y()})),2),O=j[0],S=j[1];Object(a.useEffect)((function(){return S(y()),f(d()),function(){S(null)}}),[t]);var w=function(){if(t)return n.pageSave(t._id,{custom_shares:O})},P=qe(Object(a.useState)(!1),2),x=P[0],_=P[1],E=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.size>Be.a.UPLOAD_IMAGE_SIZE_LIMIT)){e.next=3;break}return console.error(Be.a.MSG_UPLOAD_IMAGE_SIZE_ERROR),e.abrupt("return");case 3:return _(!0),e.prev=4,e.next=7,Object(Xe.o)("share-upload",t);case 7:(n=e.sent)&&n.picture&&n.picture.url&&O&&(S(Ze({},O,{},{image:n.picture.url})),!(r=w())||r instanceof Error||r.done((function(){_(!1)})).fail((function(){}))),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:_(!1);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Ke(i,r,a,o,s,"next",e)}function s(e){Ke(i,r,a,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),C=function(e){var r=e.target.getAttribute("name");if(r&&void 0!==O[r]&&t){var a=Ze({},O,{},Je({},r,e.target.value)),i=n.pageSave(t._id,{custom_shares:a});!i||i instanceof Error||i.done((function(){})).fail((function(){}))}},k=function(){return Boolean(t&&l&&t._id===l)};return i.a.createElement("form",null,i.a.createElement(c.i,{mt:"12px",position:"relative"},i.a.createElement(c.Y,{color:"white",textStyle:"small"},"OpenGraph"),i.a.createElement(c.i,{position:"absolute",right:0,top:0},i.a.createElement(v,{onClick:function(e){e.preventDefault()}}))),i.a.createElement(c.i,{width:192,height:104,mt:"12px"},i.a.createElement(c.s,{accept:"image/*",dropFile:!0,readFileData:!1,onChange:E,disabled:m()},i.a.createElement(tt,{width:192,height:104,bg:"darkGrey",borderRadius:"s",position:"relative"},x&&i.a.createElement(c.i,{position:"absolute",top:"28px",left:"72px"},i.a.createElement(c.D,{size:"medium",bgColor:"transparent"})),i.a.createElement(nt,{width:"100%",height:"100%",borderRadius:"s",_css:O&&O.image?"url(".concat(O.image,")"):"none"})))),i.a.createElement(c.i,null,i.a.createElement(rt,{name:"title",id:"share-title",translate:"no",placeholder:"Title",maxLength:128,color:"white",textStyle:"small",mt:"4px",disabled:m(),defaultValue:O&&O.title?O.title:void 0,onBlur:C}),i.a.createElement(at,{name:"description",id:"share-description",translate:"no",maxLength:2048,autoSize:!0,color:"white",textStyle:"small",mt:"4px",disabled:m(),defaultValue:O&&O.description?O.description:void 0,onBlur:C})),i.a.createElement(c.i,{mt:"16px"},i.a.createElement(it,{htmlFor:"share-tweet",_css2:Object(h.themeGet)("colors.white"),_css3:Object(h.themeGet)("textStyles.small")},"Tweet message"),i.a.createElement(ot,{name:"tweet",id:"share-tweet",translate:"no",maxLength:116,autoSize:!0,color:"white",textStyle:"small",disabled:m(),defaultValue:O&&O.tweet?O.tweet:void 0,onBlur:C})),i.a.createElement(c.t,{mt:"16px",alignItems:"center",justifyContent:"space-between"},i.a.createElement(c.i,{width:"128px"},i.a.createElement(st,{htmlFor:"all-pages",_css4:Object(h.themeGet)("colors.white"),_css5:Object(h.themeGet)("textStyles.small")},"Use these sharing settings for all pages")),i.a.createElement(c.X,{id:"all-pages",name:"all-pages",disabled:m()||!(!l||k()),checked:k(),onChange:function(e){t&&(e?(u(t._id),n.projectSave({master_share_pid:t._id})):(u(null),n.projectUnset("master_share_pid"),n.projectSave({})))}})),i.a.createElement(et,{textStyle:"small",color:"white",mt:"16px",display:p===$e.Default?"block":"none",onClick:function(e){e.preventDefault(),t&&(o?(p!==$e.Inherited&&f($e.Custom),w()):r.render())}},"Customize"),i.a.createElement(et,{textStyle:"small",color:"white",mt:"16px",display:p===$e.Custom?"block":"none",onClick:function(e){if(e.preventDefault(),t){n.pageUnset(t._id,"custom_shares");var r=n.pageSave(t._id,{});l&&(n.projectUnset("master_share_pid"),n.projectSave({}),u(null)),!r||r instanceof Error||r.done((function(e){S(y(e)),f(d(e))})).fail((function(){}))}}},"Restore to defaults"),i.a.createElement(et,{textStyle:"small",color:"white",mt:"16px",display:p===$e.Inherited?"block":"none",onClick:function(e){e.preventDefault(),l&&window.RM.constructorRouter.showWorkspace({id:l})}},"Go to master page"))})),lt=n("EcEN");function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(n,!0).forEach((function(t){gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ft=b.d.button.withConfig({displayName:"Accordion__CollapseButton"})(["width:100%;box-sizing:border-box;padding:11px 0;border:0;outline:0;background:transparent;text-align:left;transition:color 200ms,border 200ms;"]),mt=Object(b.d)(c.i).withConfig({displayName:"Accordion___StyledBox"})(["height:",";overflow:hidden;transition:height 300ms ease;"],(function(e){return e._css})),ht=function(e){var t=e.title,n=e.open,r=e.customClass,o=e.activeKey,s=e.containerHeight,l=e.count,u=e.onCollapseClick,d=e.children,g=pt(Object(a.useState)(0),2),p=g[0],f=g[1],m=pt(Object(a.useState)(0),2),h=m[0],b=m[1],y=pt(Object(a.useState)(Object(lt.v4)()),1)[0],v=Object(a.useCallback)((function(e){null!==e&&f(e.getBoundingClientRect().height)}),[]);Object(a.useEffect)((function(){s&&l&&b(s-l*p)}),[s]);var j,O=function(){return null===o&&n||o===y};return i.a.createElement(i.a.Fragment,null,i.a.createElement(ft,{className:(j="collapse-btn "+(O()?"active":"inactive"),r&&(j+=" ".concat(r)),j),ref:v,onClick:function(){return u&&u(y)}},i.a.createElement(c.Y,{textStyle:"subheading"},t)),i.a.createElement(mt,{_css:O()?Number(h)+"px":"0px"},d))},bt=function(e){var t=e.children,n=pt(Object(a.useState)({containerHeight:0,count:i.a.Children.count(t),activeKey:null}),2),r=n[0],o=n[1],s=Object(a.useCallback)((function(e){null!==e&&o(dt({},r,{containerHeight:e.getBoundingClientRect().height}))}),[]),l=function(e){o(dt({},r,{activeKey:e}))};return i.a.createElement(c.i,{width:"100%",height:"100%",ref:s},i.a.Children.map(t,(function(e){if(i.a.isValidElement(e)&&e.type===ht)return i.a.cloneElement(e,dt({},r,{onCollapseClick:l}));throw new Error("Only Collapse elements can be children of Accordion")})))};function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var vt=b.d.div.withConfig({displayName:"PageSettings__PageSettingsSidebar"})(["height:100%;width:240px;padding:0;box-sizing:border-box;position:fixed;top:0;right:0;bottom:0;z-index:",";background-color:",";overflow-x:hidden;overflow-y:auto;transform:translateX( "," );transition:transform 300ms ease;.collapse-btn.active{color:",";}.collapse-btn.inactive{color:",";}.collapse-btn.devider{border-top:2px solid ",";}"],K,Object(h.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isPageSettingsOpened?"0":"240px":e.isPageSettingsOpened?"480px":"240px"}),Object(h.themeGet)("colors.white"),Object(h.themeGet)("colors.darkGray"),Object(h.themeGet)("colors.darkGray")),jt=function(){var e=Object(a.useContext)(p),t=Object(a.useContext)(Lt),n=yt(Object(a.useState)(null),2),r=n[0],o=n[1];return Object(a.useEffect)((function(){var n=e.isPageSettingsOpened&&t.pages.find((function(e){return e.num===t.currentPageNum}))||null;return o(n),function(){o(null)}}),[e.isPageSettingsOpened,t.currentPageNum]),Object(a.useEffect)((function(){e.isPageSettingsOpened?document.body.classList.add("page-settings-is-opened"):document.body.classList.remove("page-settings-is-opened")}),[e.isPageSettingsOpened]),i.a.createElement(vt,{isPageSettingsOpened:e.isPageSettingsOpened,isSettingsOpened:e.isSettingsOpened},i.a.createElement(c.i,{height:"100%",mx:"24px"},i.a.createElement(bt,null,i.a.createElement(ht,{title:"Page SEO",open:!0},i.a.createElement(We,{currentPage:r})),i.a.createElement(ht,{title:"Social sharing",customClass:"devider"},i.a.createElement(ct,{currentPage:r})))))};function Ot(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["\n  display: block;\n  ",";\n"]);return Ot=function(){return e},e}function St(){return(St=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var wt=i.a.createElement("path",{d:"M17.485.515a1 1 0 010 1.414L10.415 9l7.07 7.071a1 1 0 01-1.414 1.414L9 10.415l-7.071 7.07a1 1 0 01-1.414-1.414L7.585 9 .516 1.929A1 1 0 011.929.515L9 7.585l7.071-7.07a1 1 0 011.414 0z",fill:"#FFF",fillRule:"evenodd"}),Pt=Object(b.d)((function(e){return i.a.createElement("svg",St({width:18,height:18},e),wt)}))(Ot(),h.color),xt=Object(b.d)(c.i).withConfig({displayName:"Settings__SettingsSidebar"})(["font-family:",";transform:translateX( "," );transition:transform 300ms ease;"],Object(h.themeGet)("fonts.main"),(function(e){return e.isSettingsOpened?e.isTrashOpened||e.isPageSettingsOpened?"-240px":"0px":"240px"}));xt.defaultProps={blacklist:["isSettingsOpened","isTrashOpened","isPageSettingsOpened","height","position","top","right","zIndex"]};var _t=Object(b.d)(c.i).withConfig({displayName:"Settings__PreviewButtonWrap"})(["width:56px;height:56px;position:fixed;right:80px;bottom:16px;color:",";background-color:",";z-index:",";cursor:pointer;:hover{background-color:",";}transform:translateX( "," );transition:transform 300ms ease,background-color 200ms ease;"],Object(h.themeGet)("colors.white"),Object(h.themeGet)("colors.darkGray"),K,Object(h.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isTrashOpened||e.isPageSettingsOpened?"-480px":"-240px":"0px"}));_t.defaultProps={blacklist:["isSettingsOpened","isTrashOpened","isPageSettingsOpened","borderRadius"]};var Et=Object(b.d)(c.t).withConfig({displayName:"Settings__SettingsToogleWrap"})(["width:56px;height:56px;position:fixed;right:16px;bottom:16px;justify-content:center;color:",";background-color:",";text-align:center;z-index:",";cursor:pointer;:hover{background-color:",";}transform:translateX( "," );transition:transform 300ms ease,background-color 200ms ease;"],Object(h.themeGet)("colors.white"),Object(h.themeGet)("colors.darkGray"),K,Object(h.themeGet)("colors.black"),(function(e){return e.isSettingsOpened?e.isTrashOpened||e.isPageSettingsOpened?"-480px":"-240px":"0px"}));Et.defaultProps={blacklist:["isSettingsOpened","isTrashOpened","isPageSettingsOpened","borderRadius"]};var Ct,kt=function(){var e=Object(a.useContext)(p);return i.a.createElement(_t,{borderRadius:"round",isSettingsOpened:e.isSettingsOpened,isTrashOpened:e.isTrashOpened,isPageSettingsOpened:e.isPageSettingsOpened,onClick:function(){return window.RM.views.toolbar.togglePreview()}},i.a.createElement(c.t,{width:"56px",height:"56px",borderRadius:"round",justifyContent:"center",alignItems:"center"},i.a.createElement(c.r,{height:"26px",width:"38px",color:"white"})))},Tt=function(){var e=Object(a.useContext)(p),t=Object(a.useContext)(Lt);return i.a.createElement(Et,{borderRadius:"round",isSettingsOpened:e.isSettingsOpened,isTrashOpened:e.isTrashOpened,isPageSettingsOpened:e.isPageSettingsOpened,onClick:function(){return e.dispatch({type:r.ToggleSettingsSidebar})}},e.isSettingsOpened?i.a.createElement(c.i,{mt:"19px"},i.a.createElement(Pt,null)):i.a.createElement(c.Y,{textStyle:"subheading",lineHeight:"56px"},t.currentPageNum))},Nt=Object(b.d)(c.i).withConfig({displayName:"Settings___StyledBox"})(["opacity:",";display:",";transition:opacity 300ms ease;"],(function(e){return e._css}),(function(e){return e._css2})),It=function(e){var t=e.projectSettingsPanel,n=Object(a.useContext)(p);return Object(a.useEffect)((function(){n.isSettingsOpened?document.body.classList.add("settings-is-shown"):document.body.classList.remove("settings-is-shown")}),[n.isSettingsOpened]),i.a.createElement(i.a.Fragment,null,i.a.createElement(kt,null),i.a.createElement(Tt,null),i.a.createElement(xt,{isSettingsOpened:n.isSettingsOpened,isTrashOpened:n.isTrashOpened,isPageSettingsOpened:n.isPageSettingsOpened,width:"240px",height:"100%",position:"fixed",top:"0",right:"0",bottom:"0",zIndex:K},i.a.createElement(c.i,{width:"240px",height:"100%",p:2,bg:"lightGray",color:"black"},i.a.createElement(c.i,{id:"page-drag-container",position:"absolute",top:"0",left:"0",width:"100%"}),i.a.createElement(x,{projectSettingsPanel:t}),i.a.createElement(je,null),i.a.createElement(Se,null)),i.a.createElement(Nt,{width:"240px",height:"100%",position:"absolute",top:"0",bottom:"0",bg:"white",_css:n.isPageSettingsOpened?"0.6":"0",_css2:n.isPageSettingsOpened?"block":"none"})),i.a.createElement(Ae,null),i.a.createElement(jt,null))};function Dt(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(n,!0).forEach((function(t){Bt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}!function(e){e.After="after",e.Before="before",e.Inside="inside",e.AfterOutside="afteroutside"}(Ct||(Ct={}));var Lt=i.a.createContext({}),Gt=function e(t,n){var r=[];for(var a in t)if(t[a].parentPage===n){var i=e(t,t[a]._id),o=Object.assign({},t[a]);i.length&&(o.children=i),r.push(o)}else if(void 0===t[a].parentPage){var s=Object.assign({},t[a]);r.push(s)}return r},Ft=function(e,t){var n={};return e.forEach((function(e){n[e._id]={collapsed:!0,children:e.children?e.children.map((function(e){return e._id})):[]}})),Object.keys(t).forEach((function(e){n[e]&&(n[e].collapsed=t[e].collapsed)})),n},Yt=function(e){var t=e.project,n=e.router,r=e.children,o=Rt(Object(a.useState)(null),2),s=o[0],c=o[1];Object(a.useEffect)((function(){var e=document.querySelector(".settings-container");e&&c(e);var t=document.getElementById("page-list-container"),n=document.getElementById("project-settings-body"),r=document.getElementById("page-drag-container");t&&b((function(e){return At({},e,{pagesListContainer:t,settingsBody:n,dragContainer:r})}))}),[]);var l=new Oe.default({$parent:document.querySelector("body > .popups"),router:n,opts:{type:"type-more-pages",is_contributor:!n.isOwner,owner_email:t.get("user")?t.get("user").email:""},alert_source:"custom sharing"}),u={projectSet:function(e,n){return t.set(e,n)},projectUnset:function(e,n){return t.unset(e,n)},projectSave:function(e,n){return t.save(e,n)},pageSet:function(e,n,r){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.set(n,r)},pageUnset:function(e,n,r){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.unset(n,r)},pageSave:function(e,n,r){var a=t.pages.get(e);if(!a)throw new Error("Element not found");return a.save(n,r)},setCurrentPageNum:function(e){b((function(t){return At({},t,{currentPageNum:e})}))},setPageCollapse:function(e,t){b((function(n){return At({},n,{pagesParams:At({},n.pagesParams,{},Bt({},e,At({},n.pagesParams[e],{collapsed:t})))})}))},addNewPage:function(e){return new Promise((function(r,a){var i=m(e,h.pages,h.pagesTree,h.pagesParams),o=i.newPageNum,s=i.newPageParentId;t.addPage({num:o},(function(e){if(e&&e.err)a(e);else{var i=e;i.isEmptyPage=!0,i.set("parentPage",s),n.pageOrder.reorderPagesAfterAdd({page:i,magId:t.get("_id")}),t.onAdd(i),n.showWorkspace({id:i.id}),t.getPage(i.id).requestNewScreenshot((function(){n.trigger("renewScreenshot",i.id)})),g(i.id),r(i)}}),!0)}))},duplicatePage:function(e){return new Promise((function(r,a){var i=t.getPage(e);if(!i)return a(new Error("Could not find page"));i.get("mid")||i.save({mid:t.get("_id")},{silent:!0});var o=m(i.get("num"),h.pages,h.pagesTree,h.pagesParams),s=o.newPageNum,c=o.newPageParentId;i.duplicate((function(e){if(e instanceof Error)return"Server error: permission_denied"===e.message&&l.render(),a(e);var i=e;i.set("parentPage",c),n.pageOrder.reorderPagesAfterAdd({page:i,magId:t.get("_id")}),t.onAdd(i),n.gg.guides.model&&(n.gg.guides.model.addPage(i.id,{silent:n.gg.guides.hidden}),n.gg.guides.model.save()),n.showWorkspace({id:i.id}),g(i.id),r(e)}),{num:s})}))},getNewPageOrderElement:function(e){var n=e.changingId,r=e.targetId,a=e.position,i=t.getPage(r),o=h.pagesParams[r],s={id:n,num:1,parentPage:null};if(a===Ct.Inside){if(!o)return new Error("insert into child element");s.num=i.get("num")+1,s.parentPage=r}else if(a===Ct.Before)s.parentPage=o?null:i.get("parentPage")||null,s.num=i.get("num");else if(a===Ct.AfterOutside){if(o)return new Error("insert after outside parent element");var c=h.pagesParams[i.get("parentPage")];if(!c||!c.children)return new Error("can not find parent page for target page");if(c.children.indexOf(r)!==c.children.length-1)return new Error("insert after outside not last child page");s.num=i.get("num")+1}else o&&o.children.length?o.collapsed?(s.num=i.get("num")+1,s.parentPage=r):(s.num=i.get("num")+o.children.length+1,s.parentPage=null):(s.parentPage=o?null:i.get("parentPage")||null,s.num=i.get("num")+1);return s},reorderPage:function(e,r){return new Promise((function(a,i){var o=t.getPage(e);if(o.get("num")===r.num&&o.get("parentPage")===r.parentPage)return a();var s=h.pagesParams[e],c=0;s&&s.children.length&&(c=s&&s.children.length),c&&(s.collapsed?n.pageOrder.removeParentIds(s.children):r.parentPage&&n.pageOrder.updateParentIds(s.children,r.parentPage)),n.pageOrder.reorderAfterDrag(o.get("num"),c,r,t.get("_id"));var l=n.workspace.getPageNum();l!==h.currentPageNum&&n.showWorkspace({num:l}),t.trigger("change:pids",t,t.get("pids")),a()}))},deletePage:function(e){return new Promise((function(r,a){if(n.isPageLocked(e))return a(new Error("This page is locked"));if(1===t.get("pids").length)return a(new Error("Can't delete last page"));var i=t.getPage(e),o=i.get("num"),s=n.workspace.getPageNum()===o,c=h.pagesParams[e],l=[];if(c){var u=h.pagesTree.find((function(t){return t._id===e})),g=[];u&&u.children&&u.children.length&&(g=u.children.map((function(e){return e._id}))),c.collapsed?n.pageOrder.removeParentIds(g):l=Dt(g)}l.push(i.get("_id")),n.pageOrder.deletePagesFromOrder(l,t.get("_id")),t.deletePages(l,(function(e){e&&e instanceof Error&&(n.pageOrder.load(t),a(e)),s&&d(o),n.removeWorkspace(i.id),r()}))}))},restorePage:function(e){return new Promise((function(r,a){t.restorePage(e,{success:function(e){var a=m(n.workspace.getPageNum(),h.pages,h.pagesTree,h.pagesParams),i=a.newPageNum,o=a.newPageParentId;e.set("num",i),e.set("parentPage",o),n.pageOrder.reorderPagesAfterAdd({page:e,magId:t.get("_id")}),t.onAdd(e),t.save(),n.showWorkspace({id:e.id}),g(e.id),r(e)},error:function(e){var t=JSON.parse(e.responseText);"permission_denied"===t.err&&l.render(),a(t)}},!0)}))},deletePagesFromTrash:function(e){return t.deleteTrashPages(e)},updateTrash:function(){return new Promise((function(e,n){t.get("has_deleted_pages")?t.fetchTrashPages().then((function(t){t&&b((function(e){return At({},e,{trashPages:t})})),e(t)})):e([])}))},emptyTrash:function(){return t.emptyTrash().then((function(){b((function(e){return At({},e,{trashPages:[]})}))}))}},d=function(e){var t=n.pageOrder.get("order"),r=null;if(e>t.length)r=t[t.length-1].id;else{var a=t.find((function(t){return t.num===e}));a&&(r=a.id)}r?(n.showWorkspace({id:r}),g(r)):n.showWorkspace({num:1})},g=function(e){if(s){var t=s.querySelector('.page-list-draggable-item[data-page-id="'.concat(e,'"]'));t&&t.scrollIntoView({behavior:"smooth"})}},p=function(e){var t=At({},e.attributes);return delete t.children,t},f=Rt(Object(a.useState)((function(){var e=t.pages.models.map((function(e){return p(e)}));e.sort((function(e,t){return e.num-t.num}));var r=Gt(e,null);return{project:t.attributes,isOwner:!!n.isOwner,pages:e,trashPages:[],currentPageNum:n.workspace.getPageNum(),pagesTree:r,pagesParams:Ft(r,{}),pagesListContainer:null,settingsBody:null,dragContainer:null}})),2),h=f[0],b=f[1],y=function(e,t){e&&b((function(n){var r=e.pages.models.map((function(e){return p(e)})).filter((function(e){return t.includes(e._id)}));r.sort((function(e,t){return e.num-t.num}));var a=Gt(r,null);return At({},n,{project:e.attributes,pages:r,pagesTree:a,pagesParams:Ft(a,n.pagesParams)})}))},v=function(e){e&&(e.changed&&e.changed.pids||b((function(t){return At({},t,{project:e.attributes})})))},j=function(e){e&&(e.changed&&(e.changed.num||e.changed.parentPage)||b((function(t){var n=O(e,t.pages);n.sort((function(e,t){return e.num-t.num}));var r=Gt(n,null);return At({},t,{pages:n,pagesTree:r,pagesParams:Ft(r,t.pagesParams)})})))},O=function(e,t){var n=h.pages.findIndex((function(t){return t._id===e.get("_id")}));return n>=0?h.pages.map((function(t,r){return r===n?p(e):t})).sort((function(e,t){return e.num-t.num})):t},S=function(e){e&&b((function(t){var n=Array.from(t.trashPages);return n.push(e.attributes),At({},t,{trashPages:n})}))},w=function(e){e&&b((function(t){var n=Array.from(t.trashPages),r=n.findIndex((function(t){return t._id===e.get("_id")}));return r>-1&&n.splice(r,1),At({},t,{trashPages:n})}))};Object(a.useEffect)((function(){return t.on("change",v),t.on("change:pids",y),t.pages.on("change",j),t.trashPages.on("add",S),t.trashPages.on("remove",w),function(){t.off("change",v),t.off("change:pids",y),t.pages.off("change",j),t.trashPages.off("add",S),t.trashPages.off("remove",w)}}),[t]);var P=function(e){u.setCurrentPageNum(e.getPageNum())};return Object(a.useEffect)((function(){return n.on("pageChange",P),function(){n.off("pageChange",P)}}),[n]),i.a.createElement(Lt.Provider,{value:At({},h,{},u)},r)},Mt=function(e){var t=e.model,n=e.router,r=e.children;return i.a.createElement(Yt,{project:t,router:n},i.a.createElement(f,{magModel:t,router:n},r))},Ut=function(e){var t=e.model,n=e.domElement,r=e.router,a=e.projectSettingsPanel;s.a.render(i.a.createElement(c.Z,null,i.a.createElement(Mt,{model:t,router:r},i.a.createElement(It,{projectSettingsPanel:a}))),n)};n.d(t,"ReorderPagePosition",(function(){return Ct})),n.d(t,"ProjectContext",(function(){return Lt})),n.d(t,"ProjectContextProvider",(function(){return Yt})),n.d(t,"SettingsController",(function(){return Mt})),n.d(t,"renderSettings",(function(){return Ut})),n.d(t,"SettingsActionTypes",(function(){return r})),n.d(t,"SettingsContext",(function(){return p})),n.d(t,"CreateSettingsContextProvider",(function(){return f}))}}]);